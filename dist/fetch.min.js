/**
 * @module fetch
 * @author nuintun
 * @license MIT
 * @version 0.3.1
 * @description A pure JavaScript window.fetch polyfill.
 * @see https://github.com/nuintun/fetch#readme
 */
!function(){"use strict";if("function"!=typeof window.fetch){var r="FormData"in window,n="ArrayBuffer"in window,o="URLSearchParams"in window,w="FileReader"in window&&"Blob"in window,i="Symbol"in window&&"iterator"in Symbol,b="XDomainRequest"in window&&document.documentMode>>0<10,t=Function.prototype.toString.call(Function);t=(t=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")).replace(/Function|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?"),t=new RegExp("^"+t+"$");var s=Object.prototype.toString,a=!!e(Object.create)&&Object.create,u=!!e(Object.setPrototypeOf)&&Object.setPrototypeOf,h=/^([a-z0-9.+-]+:)?\/\/([^/:]*)(?::([^/]*))?@/i,m=document.createElement("a"),v=location.port||{"http:":"80","https:":"443"}[location.protocol];if(A.prototype.append=function(e,t){E("Headers","append",2,arguments.length);var r=x(e);this["<names>"][r]=e;var n=this["<headers>"][r];t=R(t),this["<headers>"][r]=n?n+","+t:t},A.prototype["delete"]=function(e){E("Headers","delete",1,arguments.length),e=x(e),delete this["<headers>"][e],delete this["<names>"][e]},A.prototype.get=function(e){return E("Headers","get",1,arguments.length),e=x(e),this.has(e)?this["<headers>"][e]:null},A.prototype.has=function(e){return E("Headers","has",1,arguments.length),this["<headers>"].hasOwnProperty(x(e))},A.prototype.set=function(e,t){E("Headers","set",2,arguments.length);var r=x(e);this["<names>"][r]=e,this["<headers>"][r]=R(t)},A.prototype.forEach=function(e,t){E("Headers","forEach",1,arguments.length);var r=this["<headers>"];for(var n in r)r.hasOwnProperty(n)&&e.call(t,r[n],n,this)},A.prototype.keys=function(){var r=[];return this.forEach(function(e,t){r.push(t)}),P(r)},A.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),P(t)},A.prototype.entries=function(){var r=[];return this.forEach(function(e,t){r.push([t,e])}),P(r)},i&&(A.prototype[Symbol.iterator]=A.prototype.entries),n)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=function(e){return e&&DataView.prototype.isPrototypeOf(e)},d=ArrayBuffer.isView||function(e){return e&&-1<c.indexOf(s.call(e))};q.prototype["<body>"]=function(e){this.body=e;var t=!this.headers.has("Content-Type");"string"===y(e)?(this["<text>"]=e,t&&this.headers.set("Content-Type","text/plain;charset=UTF-8")):w&&Blob.prototype.isPrototypeOf(e)?(this["<blob>"]=e,t&&this["<blob>"].type&&this.headers.set("Content-Type",this["<blob>"].type)):r&&FormData.prototype.isPrototypeOf(e)?this["<formData>"]=e:o&&URLSearchParams.prototype.isPrototypeOf(e)?(this["<text>"]=e.toString(),t&&this.headers.set("Content-Type","application/x-www-form-urlencoded;charset=UTF-8")):n&&w&&f(e)?(this["<arrayBuffer>"]=S(e.buffer),this.body=new Blob([this["<arrayBuffer>"]])):n&&(ArrayBuffer.prototype.isPrototypeOf(e)||d(e))?this["<arrayBuffer>"]=S(e):(this["<text>"]=s.call(e),t&&this.headers.set("Content-Type","text/plain;charset=UTF-8"))},w&&(q.prototype.blob=function(){if(U(this),this["<blob>"])return Promise.resolve(this["<blob>"]);if(this["<arrayBuffer>"])return Promise.resolve(new Blob([this["<arrayBuffer>"]]));if(this["<formData>"])throw new Error("Could not read FormData body as blob");return Promise.resolve(new Blob([this["<text>"]]))},q.prototype.arrayBuffer=function(){return this["<arrayBuffer>"]?(U(this),Promise.resolve(this["<arrayBuffer>"])):this.blob().then(B)}),q.prototype.text=function(){if(U(this),this["<blob>"])return function n(e){var t=new FileReader,r=O(t);return t.readAsText(e),r}(this["<blob>"]);if(this["<arrayBuffer>"])return Promise.resolve(function o(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this["<arrayBuffer>"]));if(this["<formData>"])throw new Error("Could not read FormData body as text");return Promise.resolve(this["<text>"])},r&&(q.prototype.formData=function(){return this.text().then(j)}),q.prototype.json=function(){return this.text().then(JSON.parse)};var l=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];T(q,C),C.prototype.clone=function(){return new C(this,{body:this.body})};var p=[301,302,303,307,308];T(q,F),F.prototype.url="",F.prototype.type="default",F.prototype.redirected=!1,F.prototype.clone=function(){return new F(this.body,{status:this.status,statusText:this.statusText,headers:new A(this.headers),url:this.url})},F.error=function(){var e=new F(null,{status:0,statusText:""});return e.type="error",e},F.redirect=function(e,t){if(E("Response","redirect",1,arguments),-1===p.indexOf(t))throw new RangeError("Invalid redirect status code");return new F(null,{status:t,headers:{location:e}})},window.fetch=function D(p,y){return E("Window","fetch",1,arguments.length),new Promise(function(a,t){var u,h=function i(e){if(m.href=e,!m.host)return!1;var t=m.protocol;if(t&&t!==location.protocol)return!0;var r=m.port;return!(!r||r===v)||m.hostname!==location.hostname}((u=!y&&y instanceof C?p:new C(p,y)).url);if(h)switch(u.mode){case"same-origin":return t(new TypeError('Request mode is "same-origin" but the URL\'s origin is not same as the request origin'));case"no-cors":var e=new F;return e.ok=!1,e.status=0,e.statusText="",e.type="opaque",a(e)}var c=function s(e){return e&&b?new XDomainRequest:new XMLHttpRequest}(h),r="onload"in c;function f(e){r?e.onload=null:e.onreadystatechange=null,e.onerror=null,e.ontimeout=null,e.onabort=null}function d(e){t(new TypeError("Request "+u.url+" "+e))}function n(){f(c);var e=function i(e){var o=new A;return e.getAllResponseHeaders&&(e.getAllResponseHeaders()||"").replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),r=t.shift().trim();if(r){var n=t.join(":").trim();o.append(r,n)}}),o}(c),t="response"in c?c.response:c.responseText,r={headers:e,status:c.status||200,statusText:c.statusText};try{var n=new F(t,r)}catch(o){return d(o)}n.type=h?"cors":"basic",n.url=function s(e,t,r){return"responseURL"in e?e.responseURL:t.get("X-Request-URL")}(c,e)||u.url.replace(/#.*/,""),a(n)}r?c.onload=n:c.onreadystatechange=function(){4===c.readyState&&n()},c.onerror=function(){f(c),d("failed")},c.ontimeout=function(){f(c),d("timeout")},c.onabort=function(){f(c),d("aborted")};try{if(c.open(u.method,u.url,!0),c.timeout=Math.max(u.timeout>>0,0),c.responseType=w?"blob":"text","include"===u.credentials?c.withCredentials=!0:"omit"===u.credentials&&(c.withCredentials=!1),c.setRequestHeader){var o=u.headers;o.forEach(function(e,t){c.setRequestHeader(this["<names>"][t],e)},o)}c.send(u.body===undefined?null:u.body)}catch(l){f(c),t(l)}})},window.Headers=A,window.Request=C,window.Response=F}function e(e){return"function"==typeof e&&t.test(e)}function y(e){return null===e||e===undefined?String(e):s.call(e).replace(/\[object (\w+)\]/,"$1").toLowerCase()}function g(){}function T(e,t){var r=e.prototype;u?u(t.prototype,r):t.prototype=a?a(r):(g.prototype=r,new g),t.prototype.constructor=t}function E(e,t,r,n){if(n<r)throw new TypeError("Failed to execute '"+t+"' on '"+e+"': "+r+" arguments required, but only "+n+" present")}function x(e){if(!(e=String(e))||/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid header name");return e.toLowerCase()}function R(e){return e=String(e)}function P(t){var r=0,n=t.length,e={next:function(){var e=n<=r;return{done:e,value:e?undefined:t[r++]}}};return i&&(e[Symbol.iterator]=function(){return e}),e}function A(e){if(this["<names>"]={},this["<headers>"]={},e===undefined)return this;if(e instanceof A)e.forEach(function(e,t){this.append(t,e)},this);else if(Array.isArray(e))e.forEach(function(e){if(e.length<2)throw new TypeError("Invalid header value");var t=e[0],r=e[1];this.append(t,r)},this);else{if("object"!==y(e))throw new TypeError("The headers provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");for(var t in e)e.hasOwnProperty(t)&&this.append(t,e[t])}}function U(e){if(e.bodyUsed)throw new TypeError("Already read");e.bodyUsed=!0}function O(r){return new Promise(function(e,t){r.onload=function(){e(r.result)},r.onerror=function(){t(r.error)}})}function B(e){var t=new FileReader,r=O(t);return t.readAsArrayBuffer(e),r}function S(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function j(e){var o=new FormData;return e.trim().split("&").forEach(function(e){if(e){var t=e.split("="),r=t.shift().replace(/\+/g," "),n=t.join("=").replace(/\+/g," ");o.append(decodeURIComponent(r),decodeURIComponent(n))}}),o}function q(){this.bodyUsed=!1}function C(e,t){var r=arguments.length;if(r<1)throw new TypeError("Request construct need 1 argument required, but only "+r+" present");q.call(this);var n=(t=t||{}).body;if(e instanceof C){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.mode=e.mode,this.method=e.method,this.credentials=e.credentials,this.redirect=e.redirect,this.referrer=e.referrer,this.referrerPolicy=e.referrerPolicy,t.headers||(this.headers=new A(e.headers)),n||null===e.body||(n=e.body,e.bodyUsed=!0)}else{var o=String(e);if(function i(e){return h.test(e)}(o))throw new TypeError("Request cannot be constructed from a URL that includes credentials: "+o);if(this.url=function s(e,t){return m.href=e,m.host||(m.host=location.host),m.href}(o),this.mode=function a(e){switch(e){case"no-cors":case"navigate":case"same-origin":return e;default:return"cors"}}(t.mode),this.method=t.hasOwnProperty("method")?function u(e){var t=(e=String(e)).toUpperCase();return-1<l.indexOf(t)?t:e}(t.method):"GET",("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Request with GET/HEAD method cannot have body");this.credentials=t.credentials||"omit",this.redirect=t.redirect||"follow",this.referrer=t.referrer||"about:client",this.referrerPolicy=t.referrerPolicy||"",this.headers=new A(t.headers||{})}this["<body>"](n)}function F(e,t){q.call(this);var r=(t=t||{}).hasOwnProperty("status")?t.status>>0:200;if(1223===r&&(r=204),r<200||599<r)throw new TypeError("The response status provided ("+r+") is outside the range [200, 599]");this.status=r,this.ok=200<=r&&r<300,this.headers=new A(t.headers),this.statusText=t.statusText||(200===r?"OK":""),this["<body>"](e)}}();
//# sourceMappingURL=fetch.js.map